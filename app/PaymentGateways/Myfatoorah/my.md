UpdatePaymentStatus
Endpoint

Suggest Edits
Overview
The "UpdatePaymentStatus" endpoint is a POST request. It is used to either capture fully/partially the invoice amount or release the amount back into the customer's account. Detailed functionality of how to use this endpoint is explained below.

The endpoint on Swagger is: Payment_UpdatePaymentStatus.

Now, we are going to declare the endpoint and its models along with each accepted parameter and possible value.

ðŸš§
Number of Processes

Please notice that you can make only one Capture/Release operation on each invoice.

Request Model
The request is a POST request with the following parameters:

Input Parameter	Type	Description
Operation	string	"Capture": Refers to capturing fully or partially the invoice value.
"Release": Refers to releasing fully the invoice value to the customer's account.
Amount	float	The amount to be captured/released.
Capture: The amount has to be less than or equal to the invoice value. Mandatory
Release: The amount has to be equal to the invoice value. Optional
Key	string	Refers to the Invoice ID, payment ID, or Customer Reference based on the key type
KeyType	string	"InvoiceId": Refers to the invoice number that MyFatoorah generates

"PaymentId": The value is returned upon having any update on the invoice payment

"CustomerReference": The reference used to link your orders in the store
ðŸ‘
PaymentId

We strongly recommend to use the value PaymentId (which is returned in the CallBackURL ) to update the payment status, this will get you full information about the invoice that you can use within your application. As long as there is not payment or transactions done for a certain invoice, you can inquire using InvoiceId.

Response Model
After viewing the Response Model that you will get as a result of your request, here, you will find complete details about the Data Model of this API endpoint. Let's check it and its contents.

Response Field	Type	Description
InvoiceId	number	Represents the invoice ID that was used in the inquiry call
InvoiceStatus	string	"Pending": The customer made the payment but no operations on it OR A release is made on the amount.
"Paid": A capture is made on the amount
InvoiceReference	string	Invoice reference that MyFatoorah generates
CustomerReference	string	The customer reference data associated with the invoice
CreatedDate	string	The creation date of the invoice
ExpiryDate	string	The expiry date for the invoice
InvoiceValue	number	The value of Capture/Release
Comments	string	Comments that are associated with the invoice (mainly used by portal users)
CustomerName	string	The customer name that was save along with the invoice
CustomerMobile	string	Customer mobile number
CustomerEmail	string	Customer email address
UserDefinedField	string	The user-defined field that was stored during the invoice creation
InvoiceDisplayValue	string	Invoice value that is displayed in case of a different currency from the base one
DueDeposit	number	The amount that will be deposited to the vendor
DepositStatus	string	The deposit status of the invoice, if it is "Deposited" or "Not Deposited".
InvoiceItems	Array of InvoiceItemModel objects	
InvoiceTransactions	Array of InvoiceTransactionModel objects	
InvoiceItemModel
Response Field	Type	Description
ItemName	string	Invoice item name that is stored with the invoice
Quantity	integer	Item Quantity
UnitPrice	number	Item unit price
Weight	number	100 >= Weight > 0
Weight in kg
Width	number	200 >= Width > 0
Width in cm
Height	number	160 >= Height > 0
Height in cm
Depth	number	200 >= Depth > 0
Depth in cm
InvoiceTransactionModel
Response Field	Type	Description
TransactionDate	string	The date of the transaction related to the invoice
PaymentGateway	string	The gateway the transaction was processed through
ReferenceId	string	The reference that is generated by the payment gateway
TrackId	string	The track number that is used to track the transaction with the gateway
TransactionId	string	The transaction ID
PaymentId	string	The payment ID that is assigned to this transaction
AuthorizationId	string	The authorization ID that is assigned to this transaction
TransactionStatus	string	The status of the transaction could be any of:
InProgress: The payment attempt is not completed
Succss: The capture was successful
Failed: A transaction attempt failed
Authorize: The client makes the payment
Canceled: The amount is released
TransationValue	string	The value of the transaction
CustomerServiceCharge	string	The service charges considered on the customer during the transaction
TotalServiceCharge	string	Total service charge deducted from MyFatoorah side
DueValue	string	The amount value of this transaction
PaidCurrency	string	The currency that was used to pay the transaction
PaidCurrencyValue	string	The currency value that was used to pay the transaction
VatAmount	string	The value of the VAT amount for the transaction.
Currency	string	Transaction currency
Error	string	The error message that might be associated with the transaction.
This error is from the acquirer bank/platform
ErrorCode	string	The MyFatoorah error code. Kindly, refer to the Error Codes table.
ðŸ“˜
Transactions

Transactions information are totally related to the gateway response that came from the acquirer bank / platform. Not necessarily to have information to all the fields, and this was designed only to provide you information about all transactions that happened for a certain invoice

Sample Message
Capture Request:

Capture Request
Capture Response

{
  "Operation": "capture",
  "Amount": 100,
  "Key": "2834690",
  "KeyType": "Invoiceid"
}
Kindly note that if the "amount" in the capture request is less than the primary "InvoiceValue", the "InvoiceValue" in the response will change to the amount entered in the request.

Release Request:

Release Request
Release Response

{
  "Operation": "release",
  "Amount": 250,
  "Key": "2834691",
  "KeyType": "Invoiceid"
}
Sample Code
PHP

<?php

/* For simplicity check our PHP SDK library here https://myfatoorah.readme.io/php-library */

//PHP Notice:  To enable MyFatoorah auto-update, kindly give the write/read permissions to the library folder
//use zip file
include 'myfatoorah-library-2.2/MyfatoorahLoader.php';
include 'myfatoorah-library-2.2/MyfatoorahLibrary.php';

//use composer
//require 'vendor/autoload.php';
//use MyFatoorah\Library\MyFatoorah;

/* --------------------------- Configurations ------------------------------- */
//Test
$mfConfig = [
    /**
     * API Token Key (string)
     * Accepted value:
     * Live Token: https://myfatoorah.readme.io/docs/live-token
     * Test Token: https://myfatoorah.readme.io/docs/test-token
     */
    'apiKey' => '',
    /*
     * Vendor Country ISO Code (string)
     * Accepted value: KWT, SAU, ARE, QAT, BHR, OMN, JOD, or EGY. Check https://docs.myfatoorah.com/docs/iso-lookups
     */
    'vcCode' => 'KWT',
    /**
     * Test Mode (boolean)
     * Accepted value: true for the test mode or false for the live mode
     */
    'isTest' => true,
];

/* --------------------------- UpdatePaymentStatus Endpoint ----------------- */

//------------- Post Fields -------------------------
//Check https://docs.myfatoorah.com/docs/updatepaymentstatus#request-model
$postFields = [
    'Operation' => 'capture', //or 'release'
    'Amount'    => 1,
    'Key'       => '2834690',
    'KeyType'   => 'Invoiceid', //'PaymentId', or 'CustomerReference'
];

//------------- Call the Endpoint -------------------------
try {
    $mfObj  = new MyFatoorah($mfConfig);
    $apiURL = $mfObj->getApiUrl();
    $obj    = $mfObj->callAPI("$apiURL/v2/UpdatePaymentStatus", $postFields);

    //Display the result to your customer
    echo '<h3><u>UpdatePaymentStatus Response Object:</u></h3><pre>';
    print_r($obj);
    echo '</pre>';
} catch (Exception $ex) {
    echo $ex->getMessage();
    die;
}



/v2/GetPaymentStatus
Response Class (Status 200)
OK

ModelExample Value
{
  "IsSuccess": true,
  "Message": "string",
  "ValidationErrors": [
    {
      "Name": "string",
      "Error": "string"
    }
  ],
  "Data": {
    "InvoiceId": 0,
    "InvoiceStatus": "string",
    "InvoiceReference": "string",
    "CustomerReference": "string",
    "CreatedDate": "2025-05-19T14:06:03.616Z",
    "ExpiryDate": "string",
    "ExpiryTime": "string",
    "InvoiceValue": 0,
    "Comments": "string",
    "CustomerName": "string",
    "CustomerMobile": "string",
    "CustomerEmail": "string",
    "UserDefinedField": "string",
    "InvoiceDisplayValue": "string",
    "DueDeposit": 0,
    "DepositStatus": "string",
    "InvoiceItems": [
      {
        "ItemName": "string",
        "Quantity": 0,
        "UnitPrice": 0,
        "Weight": 0,
        "Width": 0,
        "Height": 0,
        "Depth": 0
      }
    ],
    "InvoiceTransactions": [
      {
        "TransactionDate": "2025-05-19T14:06:03.616Z",
        "PaymentGateway": "string",
        "ReferenceId": "string",
        "TrackId": "string",
        "TransactionId": "string",
        "PaymentId": "string",
        "AuthorizationId": "string",
        "TransactionStatus": "string",
        "TransationValue": "string",
        "CustomerServiceCharge": "string",
        "TotalServiceCharge": "string",
        "DueValue": "string",
        "PaidCurrency": "string",
        "PaidCurrencyValue": "string",
        "VatAmount": "string",
        "IpAddress": "string",
        "Country": "string",
        "Currency": "string",
        "Error": "string",
        "CardNumber": "string",
        "ErrorCode": "string",
        "ECI": "string",
        "Card": {}
      }
    ],
    "Suppliers": [
      {
        "SupplierCode": 0,
        "SupplierName": "string",
        "InvoiceShare": 0,
        "ProposedShare": 0,
        "DepositShare": 0
      }
    ]
  }
}

GetPaymentStatus
Endpoint

Suggest Edits
Overview
The "GetPaymentStatus" endpoint is a POST request. It is used to check the status of your invoice to assure that the payment has been done successfully or not. Detailed functionality of how to use this endpoint is explained in the Payment Inquiry section.

The endpoint on Swagger is: Payment_GetPaymentStatus.

Now, we are going to declare the endpoint and its models along with each accepted parameter and possible value.

ðŸ“˜
Request Header

Add "Authorization": "Bearer {Token}" to request header. Token of demo configuration can be found here.

ðŸš§
Many calls to GetPaymentStatus

GetPaymentStatus endpoint has a rate limit. If you are going to send a lot of requests to the endpoint in a short duration, please contact the account manager to increase the rate limit for your account.

Request Model
The request is a POST request with the following parameters:

Input Parameter	Type	Description
Key	string	Refers to the invoice number or payment ID based on the key type
KeyType	string	"InvoiceId" Refers to the invoice number that is generated by MyFatoorah

"PaymentId" the value is returned upon having any update on the invoice payment

"CustomerReference" The reference used to link your orders in the store
ðŸ‘
PaymentId

We strongly recommend to use the value PaymentId (which is returned in the CallBackURL ) to inquire the payment status, this will get you full information about the invoice that you can use within your application. As long as there is not payment or transactions done for a certain invoice, you can inquire using InvoiceId

Response Model
After viewing the Response Model that you will get as a result of your request, here, you will find full details about the Data Model of this API endpoint. Let's check it and its contents.

Response Field	Type	Description
InvoiceId	number	Represents the invoice ID that was used in the inquiry call
InvoiceStatus	string	"Pending"
"Paid"
"Canceled"
InvoiceReference	string	Invoice reference that is generated by MyFatoorah
CustomerReference	string	The customer reference data associated with the invoice
CreatedDate	string	The creation date of the invoice
ExpiryDate	string	The expiry date for the invoice
InvoiceValue	number	Invoice total value with the actual base account currency
Comments	string	Comments that are associated with the invoice (mainly used portal use users)
CustomerName	string	The customer name that was save along with the invoice
CustomerMobile	string	Customer mobile number
CustomerEmail	string	Customer email address
UserDefinedField	string	The user defined filed that was stored during the invoice creation
InvoiceDisplayValue	string	Invoice value that is displayed in case of different currency from the base one
DueDeposit	number	The amount that will be deposited to the vendor
DepositStatus	string	The deposit status of the invoice, if it is "Deposited" or "Not Deposited".
InvoiceItems	Array of InvoiceItemModel objects	
InvoiceTransactions	Array of InvoiceTransactionModel objects	
InvoiceItemModel
Response Field	Type	Description
ItemName	string	Invoice item name that is stored with the invoice
Quantity	integer	Item quantity
UnitPrice	number	Item unit price
Weight	number	100 >= Weight > 0
Weight in kg
Width	number	200 >= Width > 0
Width in cm
Height	number	160 >= Height > 0
Height in cm
Depth	number	200 >= Depth > 0
Depth in cm
InvoiceTransactionModel
Response Field	Type	Description
TransactionDate	string	The date of the transaction related to the invoice
PaymentGateway	string	The gateway the transaction was processed through
ReferenceId	string	The reference that is generated by the payment gateway
TrackId	string	The track number that is used to track the transaction with the gateway
TransactionId	string	The transaction ID
PaymentId	string	The payment ID that is assigned to this transaction
AuthorizationId	string	The authorization ID that is assigned to this transaction
TransactionStatus	string	The status of the transaction as
InProgress
Succss
Failed
Canceled
Authorize
TransationValue	string	The value of the transaction
CustomerServiceCharge	string	The service charges considered on the customer during the transaction
TotalServiceCharge	string	Total service charge deducted from MyFatoorah side
DueValue	string	The amount value of this transaction
PaidCurrency	string	The currency that was used to pay the transaction
PaidCurrencyValue	string	The currency value that was used to pay the transaction
VatAmount	float	The value of the VAT amount for the transaction
Currency	string	Transaction currency
Error	string	The error message that might be associated with the transaction.
This error is from the acquirer bank / platform
CardNumber	string	The masked card number that was used for the transaction.
ErrorCode	string	The MyFatoorah error code. Kindly, refer to the Error Codes table.
ECI	string	The ECI record of the transaction.
ðŸ“˜
Transactions

Transactions information are totally related to the gateway response that came from the acquirer bank / platform. Not necessarily to have information to all the fields, and this was designed only to provide you information about all transactions that happened for a certain invoice

Error Codes
Code	Explanation
MF001	3DS authentication failed, possible reasons (user inserted a wrong password, cardholder/card issuer are not enrolled with 3DS, or the issuer bank has technical issue).
MF002	The issuer bank has declined the transaction, possible reasons (invalid card details, insufficient funds, denied by risk, the card is expired/held, or card is not enabled for online purchase).
MF003	The transaction has been blocked from the gateway, possible reasons (unsupported card BIN, fraud detection, or security blocking rules).
MF004	Insufficient funds
MF005	Session timeout
MF006	Transaction canceled
MF007	The card is expired.
MF008	The card issuer doesn't respond.
MF009	Denied by Risk
MF010	Wrong Security Code
MF020	Unspecified Failure
Sample Message
Now, you can get all the information about the invoice transactions and suppliers - if exist - and the deposit amount of each supplier.

Payment Enquiry Request
Payment Enquiry Response
Multi-suppliers Enquiry Response

{
  "Key": "2725229",
  "KeyType": "InvoiceId"
}
